<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Add Edit  Address Page</title>
</head>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
<link rel="stylesheet" href="/CSS/user-welcome.css">
<link rel="icon" type="image/x-icon" href="/assets/240_F_328494327_A2XpjDQp8f74FsQh7W7yof1tXU9ob3Sb.jpg">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css">
<!-- SweetAlert2 CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

<!-- SweetAlert2 JS -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<!-- -----// font awsom ----- -->
<script src="https://kit.fontawesome.com/1f94a7e510.js" crossorigin="anonymous"></script>

<body>
     <!--header-->
     <%- include('../partials/userHeader') %>





    <main>

        <div class="container-fluid ">
            <div class="row d-flex justify-content-center   py-5 mt-5">
                <div class="col-12" id="referral" >
                    <div class="d-flex justify-content-between bg-white shadow-sm rounded-3 border p-3 m-3">
                        <p class="fs-4 fw-bold m-0">Referrals</p>
                        <button type="button" id="referral-link" value="http://localhost:8848/signup?ref=<%= newuser._id %>" class="btn btn-dark btn-sm">Click Here to Copy the Referral Link</button>
                    </div>
                    <div class="row">
                        <div class="col-12 ">
                            <div class="d-flex justify-content-between bg-white border shadow-sm rounded-3 p-3 m-3">
                                <table class="table table-borderless text-center">
                                    <tr>
                                        <th>#Sl No</th>
                                        <th>User Name</th>
                                        <th>Cash Earned</th>
                                    </tr>
                                    <% newuser.referredUsers.forEach((x,index) => { %>
                                        
    
                                        <tr>
                                            <td><%= index+1 %></td>
                                            <td><%=x.Username  %></td>
                                            <td>Rs.100</td>
                                        </tr>
                                     
                                    <% }) %>
                                  

                                    <tr>
                                        <td colspan="2"></td>
                                        <th class="fs-4 fw-bold">Total Earned: Rs.<%= newuser.ReferedAmount %></th>
                                    </tr>

                                </table>
                            </div>
                        </div>
                    </div>
                    <% if (newuser.ReferredBy) { %>
                        <p class="text-center">You were Referred by <span class="fw-bold text-success"><%=newuser.ReferredBy.Username  %></span></p>
                     
                    <% } %>
                    
                </div>
            </div>
        </div>
    

        <% if (orderList.length> 0) { %>
            <div class="d-flex justify-content-between m-auto w-50 align-items-center mt-3">
                <p>Showing <%= (currentPage - 1) * perPage + 1 %>-
                        <% if(currentPage===totalPages){%>
                            <%=totalCount%>
                                <%}else{%>
                                    <%= currentPage * perPage %>
                                        <%}%>
                                            results from <%= totalCount %>
                </p>
                <ul class="pagination">
                    <% for (let i=1; i <=totalPages; i++) { %>
                        <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                            <a class="page-link" href="?page=<%= i %>">
                                <%= i %>
                            </a>
                        </li>
                        <% } %>
                </ul>
            </div>
            <% } %>

    </main>


    
                              <!-------------------footer-------------------->
    
  
   
    
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const referralLinkButton = document.getElementById("referral-link");

            referralLinkButton.addEventListener("click", function () {
                // Select the text in the button
                const linkToCopy = document.createElement("textarea");
                linkToCopy.value = referralLinkButton.value;
                document.body.appendChild(linkToCopy);
                linkToCopy.select();
                
                // Copy the text to the clipboard
                document.execCommand("copy");

                // Clean up and remove the temporary textarea
                document.body.removeChild(linkToCopy);

                // Optionally, provide some feedback to the user
                alert("Referral link copied to clipboard!");
            });
        });
    </script>

    <%- include('../partials/userFooterOffcanavas') %>

    <script src="/js/user-address.js"></script>
    <script src="/js/signup.js"></script>
</body>

</html>

    